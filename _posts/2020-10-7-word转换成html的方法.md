---
layout:     post
title:      word转换成html的方法
subtitle:   
date:       2020-10-7
author:     coderidea
header-style: text
catalog: true
tags:
- 程序人生
- 网站设计

--- 
<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body"><p>      之前用到了word转换成HTMl的做法，网上找过一段类似的代码，后发现好多不能执行，调试了半天才最终搞定。</p>
<p>       方法接参数是word文件路径。 执行这样的代码，需要添加 Microsoft.Office.Interop.Word.dll引用。</p>
<div class="cnblogs_code">
<pre>        <span style="color:#808080;">///</span><span style="color:#008000;"> </span><span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"><br /></span><span style="color:#808080;">///</span><span style="color:#008000;"> Word转换为HTML<br /></span><span style="color:#808080;">///</span><span style="color:#008000;"> </span><span style="color:#808080;">&lt;/summary&gt;</span><span style="color:#008000;"><br /></span><span style="color:#808080;">///</span><span style="color:#008000;"> </span><span style="color:#808080;">&lt;param name="path"&gt;&lt;/param&gt;</span><span style="color:#808080;"><br /></span>        <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">string</span> WordToHTMl(<span style="color:#0000ff;">ref</span> <span style="color:#0000ff;">string</span> path)<br />        {<br /><span style="color:#0000ff;">string</span> pageUrl = <span style="color:#0000ff;">null</span>;<br /><br /><span style="color:#0000ff;">object</span> fltDocFormat = <span style="color:#800080;">10</span>; <span style="color:#008000;">//</span><span style="color:#008000;">For filtered HTML Output</span><span style="color:#008000;"><br /></span>            <span style="color:#0000ff;">object</span> missing = System.Reflection.Missing.Value;<br /><span style="color:#0000ff;">object</span> readOnly = <span style="color:#0000ff;">false</span>; <span style="color:#008000;">//</span><span style="color:#008000;">Open file in readOnly mode</span><span style="color:#008000;"><br /></span>            <span style="color:#0000ff;">object</span> isVisible = <span style="color:#0000ff;">false</span>;<span style="color:#008000;">//</span><span style="color:#008000;">The process has to be in invisible mode</span><span style="color:#008000;"><br /></span>            <span style="color:#0000ff;">object</span> fileName = path;<br /><br /><span style="color:#008000;">//</span><span style="color:#008000;">获取网站服务器端的路径</span><span style="color:#008000;"><br /></span>            <span style="color:#0000ff;">string</span> newPath = System.Web.HttpContext.Current.Server.MapPath(<span style="color:#800000;">"</span><span style="color:#800000;">/ConvertFiles/</span><span style="color:#800000;">"</span>);<br /><span style="color:#0000ff;">string</span> newFileName = System.IO.Path.GetFileNameWithoutExtension(fileName.ToString());<br /><span style="color:#0000ff;">object</span> saveFileName = newPath + savePath + newFileName + <span style="color:#800000;">"</span><span style="color:#800000;">.html</span><span style="color:#800000;">"</span>;<br /><span style="color:#008000;"><br /></span><span style="color:#008000;">//</span><span style="color:#008000;">判断文件是否被转换</span><span style="color:#008000;"><br /></span>            <span style="color:#0000ff;">if</span> (!System.IO.File.Exists(SaveFileName))<br />            {<br /><br />                Microsoft.Office.Interop.Word.ApplicationClass objWord = <span style="color:#0000ff;">new</span> Microsoft.Office.Interop.Word.ApplicationClass();<br /><span style="color:#008000;">//打开word文档</span><span style="color:#008000;"><br /></span>                objWord.Documents.Open(<span style="color:#0000ff;">ref</span> fileName, <span style="color:#0000ff;">ref</span> readOnly, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> isVisible, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing);<br /><span style="color:#008000;">//</span><span style="color:#008000;">Do the background activity</span><span style="color:#008000;"><br /></span>                objWord.Visible = <span style="color:#0000ff;">false</span>;<br />                Microsoft.Office.Interop.Word.Document oDoc = objWord.ActiveDocument;<br /><br />                oDoc.SaveAs(<span style="color:#0000ff;">ref</span> saveFileName, <span style="color:#0000ff;">ref</span> fltDocFormat, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing);<br />                oDoc.Close(<span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing);<br />                objWord.Quit(<span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing, <span style="color:#0000ff;">ref</span> missing);<br /><span style="color:#008000;">//</span><span style="color:#008000;">Process[] myProcesses = Process.GetProcessesByName("WINWORD");<br /></span><span style="color:#008000;">//</span><span style="color:#008000;">foreach (Process myProcess in myProcesses)<br /></span><span style="color:#008000;">//</span><span style="color:#008000;">{<br /></span><span style="color:#008000;">//</span><span style="color:#008000;">    myProcess.Kill();<br /></span><span style="color:#008000;">//</span><span style="color:#008000;">}<br /><br /></span><span style="color:#008000;">//</span><span style="color:#008000;">   string pageUrl = newFileName + ".html";<br /></span><span style="color:#008000;">//</span><span style="color:#008000;"> System.Web.HttpContext.Current.Server.Transfer(pageUrl);</span>              <span style="color:#008000;"><br /></span>            }<br /><br /><span style="color:#0000ff;">else</span><br />            {<br /><span style="color:#008000;">//</span><span style="color:#008000;">页面路径</span><span style="color:#008000;"><br /></span>                pageUrl = IpPath + FileName + <span style="color:#800000;">"</span><span style="color:#800000;">.html</span><span style="color:#800000;">"</span>;<br /><span style="color:#008000;"><br /></span>            }<br /><span style="color:#0000ff;">return</span> pageUrl;<br /><br /><br />        }</pre>
</div></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


		</div>